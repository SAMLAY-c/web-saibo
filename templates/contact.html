{% extends "base.html" %}

{% block title %}è”ç³»æˆ‘ä»¬ - Flask Web åº”ç”¨{% endblock %}

{% block header_title %}è”ç³»æˆ‘ä»¬{% endblock %}

{% block content %}
    <div style="background: #e8f4fd; padding: 20px; border-radius: 5px; margin-bottom: 20px;">
        <h3>ğŸ“§ Flask-WTF è¡¨å•åŠŸèƒ½æ¼”ç¤º</h3>
        <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Flask-WTF æ‰©å±•åˆ›å»ºä¸“ä¸šçš„è¡¨å•ï¼ŒåŒ…å«è‡ªåŠ¨éªŒè¯ã€CSRF ä¿æŠ¤å’Œé”™è¯¯å¤„ç†åŠŸèƒ½ã€‚</p>
    </div>

    <!-- Flash æ¶ˆæ¯æ˜¾ç¤º -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-message flash-{{ category }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div style="background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px;">
        <h4>ğŸ“‹ è¡¨å•åŠŸèƒ½ç‰¹ç‚¹</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 15px;">
            <div style="background: white; padding: 10px; border-radius: 3px; text-align: center; border: 1px solid #dee2e6;">
                <strong>ğŸ”’ CSRF ä¿æŠ¤</strong><br>
                è‡ªåŠ¨é˜²å¾¡è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»
            </div>
            <div style="background: white; padding: 10px; border-radius: 3px; text-align: center; border: 1px solid #dee2e6;">
                <strong>âœ… æ•°æ®éªŒè¯</strong><br>
                è‡ªåŠ¨éªŒè¯é‚®ç®±æ ¼å¼å’Œå¿…å¡«å­—æ®µ
            </div>
            <div style="background: white; padding: 10px; border-radius: 3px; text-align: center; border: 1px solid #dee2e6;">
                <strong>ğŸ› ï¸ é”™è¯¯å¤„ç†</strong><br>
                å‹å¥½çš„é”™è¯¯æç¤ºå’Œè‡ªåŠ¨è¡¨å•å¡«å……
            </div>
        </div>
    </div>

    <div style="background: white; padding: 30px; border-radius: 5px; border: 1px solid #dee2e6; margin-bottom: 20px;">
        <h4>ğŸ“ è”ç³»æˆ‘ä»¬</h4>
        <p style="color: #6c757d; margin-bottom: 20px;">è¯·å¡«å†™ä¸‹é¢çš„è¡¨å•ï¼Œæˆ‘ä»¬ä¼šå°½å¿«å›å¤æ‚¨çš„æ¶ˆæ¯ã€‚</p>

        <form method="POST" action="{{ url_for('contact') }}" novalidate>
            <!-- 1. è¿™æ˜¯ CSRF ä¿æŠ¤ä»¤ç‰Œï¼Œå¿…é¡»æ·»åŠ ï¼ -->
            {{ form.hidden_tag() }}

            <div style="margin-bottom: 20px;">
                <!-- 2. æ¸²æŸ“ Label å’Œè¾“å…¥æ¡† -->
                {{ form.name.label(style="display: block; margin-bottom: 5px; font-weight: bold;") }}<br>
                {{ form.name(size=30, class="form-input", style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px;") }}

                <!-- 3. æ¸²æŸ“éªŒè¯é”™è¯¯ä¿¡æ¯ -->
                {% if form.name.errors %}
                    <div style="margin-top: 5px;">
                        {% for error in form.name.errors %}
                            <div style="color: #dc3545; font-size: 14px;">{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div style="margin-bottom: 20px;">
                {{ form.email.label(style="display: block; margin-bottom: 5px; font-weight: bold;") }}<br>
                {{ form.email(size=30, class="form-input", style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px;") }}
                {% if form.email.errors %}
                    <div style="margin-top: 5px;">
                        {% for error in form.email.errors %}
                            <div style="color: #dc3545; font-size: 14px;">{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div style="margin-bottom: 20px;">
                {{ form.message.label(style="display: block; margin-bottom: 5px; font-weight: bold;") }}<br>
                {{ form.message(rows=5, cols=32, class="form-input", style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; resize: vertical;") }}
                {% if form.message.errors %}
                    <div style="margin-top: 5px;">
                        {% for error in form.message.errors %}
                            <div style="color: #dc3545; font-size: 14px;">{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div>
                {{ form.submit(class="btn btn-primary", style="background: #007bff; color: white; padding: 12px 30px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;") }}
            </div>
        </form>
    </div>

    <div style="background: #fff3cd; padding: 20px; border-radius: 5px; margin-bottom: 20px;">
        <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
        <div style="margin-top: 15px;">
            <h5>ğŸ§ª æµ‹è¯•éªŒè¯åŠŸèƒ½ï¼š</h5>
            <ol style="margin: 10px 0; padding-left: 20px;">
                <li><strong>ç©ºå­—æ®µæµ‹è¯•</strong>ï¼šç›´æ¥ç‚¹å‡»æäº¤ï¼Œä¼šçœ‹åˆ°æ‰€æœ‰å­—æ®µçš„çº¢è‰²é”™è¯¯æç¤º</li>
                <li><strong>é‚®ç®±éªŒè¯</strong>ï¼šè¾“å…¥æ— æ•ˆé‚®ç®±ï¼ˆå¦‚ "abc"ï¼‰ï¼Œä¼šçœ‹åˆ°é‚®ç®±æ ¼å¼éªŒè¯é”™è¯¯</li>
                <li><strong>æˆåŠŸæäº¤</strong>ï¼šå¡«å†™æ‰€æœ‰æœ‰æ•ˆä¿¡æ¯åæäº¤ï¼Œä¼šçœ‹åˆ°æˆåŠŸæ¶ˆæ¯</li>
            </ol>
        </div>

        <div style="margin-top: 20px;">
            <h5>ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§ï¼š</h5>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>CSRF ä»¤ç‰Œ</strong>ï¼šè¡¨å•åŒ…å«éšè—çš„ CSRF ä¿æŠ¤ä»¤ç‰Œ</li>
                <li><strong>æ•°æ®éªŒè¯</strong>ï¼šæœåŠ¡å™¨ç«¯éªŒè¯ç¡®ä¿æ•°æ®å®Œæ•´æ€§</li>
                <li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®‰å…¨çš„é”™è¯¯ä¿¡æ¯æ˜¾ç¤º</li>
                <li><strong>é˜²æ­¢æ³¨å…¥</strong>ï¼šWTForms è‡ªåŠ¨é˜²æ­¢ XSS æ”»å‡»</li>
            </ul>
        </div>
    </div>

    <div style="background: #d1ecf1; padding: 20px; border-radius: 5px;">
        <h4>ğŸ› ï¸ æŠ€æœ¯å®ç°è¦ç‚¹</h4>
        <div style="margin-top: 15px;">
            <h5>åç«¯æŠ€æœ¯ï¼š</h5>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>FlaskForm</strong>ï¼šæ‰€æœ‰è¡¨å•ç±»ç»§æ‰¿è‡ª FlaskForm</li>
                <li><strong>validators</strong>ï¼šä½¿ç”¨ DataRequired, Email ç­‰éªŒè¯å™¨</li>
                <li><strong>validate_on_submit()</strong>ï¼šä¼˜é›…çš„è¡¨å•å¤„ç†æ–¹æ³•</li>
                <li><strong>form.data</strong>ï¼šå®‰å…¨åœ°è·å–è¡¨å•æ•°æ®</li>
            </ul>
        </div>

        <div style="margin-top: 15px;">
            <h5>æ¨¡æ¿æŠ€æœ¯ï¼š</h5>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>{{ form.hidden_tag() }}</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ CSRF ä»¤ç‰Œ</li>
                <li><strong>{{ form.name.label }}</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾å…ƒç´ </li>
                <li><strong>{{ form.name() }}</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆè¾“å…¥æ¡†</li>
                <li><strong>{{ form.name.errors }}</strong>ï¼šæ˜¾ç¤ºéªŒè¯é”™è¯¯ä¿¡æ¯</li>
            </ul>
        </div>
    </div>
{% endblock %}