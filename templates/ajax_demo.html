<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AJAX Demo - Flask Web åº”ç”¨</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .demo-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
        }

        .button-container {
            margin: 20px 0;
        }

        .btn {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .btn-hello {
            background: #28a745;
            color: white;
        }

        .btn-hello:hover {
            background: #218838;
        }

        .btn-goodbye {
            background: #dc3545;
            color: white;
        }

        .btn-goodbye:hover {
            background: #c82333;
        }

        .btn-reset {
            background: #6c757d;
            color: white;
        }

        .btn-reset:hover {
            background: #5a6268;
        }

        .test-links {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }

        .test-links a {
            margin-right: 15px;
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .test-links a:hover {
            text-decoration: underline;
        }

        .status-display {
            margin: 20px 0;
            padding: 15px;
            background: #e8f4fd;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }

        .response-log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
        }

        .loading {
            display: none;
            color: #007bff;
            font-style: italic;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #f5c6cb;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ğŸš€ AJAX äº¤äº’æ¼”ç¤º</h1>

    <div class="demo-section">
        <h3>ğŸ“– ä»€ä¹ˆæ˜¯AJAXï¼Ÿ</h3>
        <p><strong>AJAX (Asynchronous JavaScript and XML)</strong> æ˜¯ä¸€ç§å‰ç«¯æŠ€æœ¯ï¼Œå…è®¸æµè§ˆå™¨åœ¨<strong>ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µ</strong>çš„æƒ…å†µä¸‹ä¸æœåŠ¡å™¨è¿›è¡Œæ•°æ®äº¤æ¢ã€‚</p>
        <p>è¿™åˆ›é€ äº†æµç•…ã€å¿«é€Ÿã€å“åº”çµæ•çš„ç”¨æˆ·ä½“éªŒï¼Œè®©ä½ çš„ç½‘é¡µæ„Ÿè§‰æ›´åƒæ¡Œé¢åº”ç”¨ç¨‹åºã€‚</p>
    </div>

    <div class="demo-section">
        <h3>ğŸ® äº¤äº’æ¼”ç¤º</h3>
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ï¼Œè§‚å¯Ÿé¡µé¢å˜åŒ–ï¼ˆ<strong>é¡µé¢ä¸ä¼šåˆ·æ–°</strong>ï¼‰ï¼š</p>

        <div class="button-container">
            <button class="btn btn-hello" onclick="sayHello()">ğŸ‘‹ å‘¼å« Hello</button>
            <button class="btn btn-goodbye" onclick="sayGoodbye()">ğŸ‘‹ å‘¼å« Goodbye</button>
            <button class="btn btn-reset" onclick="resetStyles()">ğŸ”„ é‡ç½®æ ·å¼</button>
        </div>

        <div class="loading" id="loading">æ­£åœ¨å¤„ç†è¯·æ±‚...</div>
        <div class="success-message" id="successMessage"></div>
        <div class="error-message" id="errorMessage"></div>
    </div>

    <div class="test-links">
        <h4>ğŸ”— æµ‹è¯•é“¾æ¥ï¼ˆç”¨äºè§‚å¯Ÿé¢œè‰²å˜åŒ–ï¼‰</h4>
        <a href="#">é“¾æ¥1</a>
        <a href="#">é“¾æ¥2</a>
        <a href="#">é“¾æ¥3</a>
        <a href="#">Flaskä¸»é¡µ</a>
        <a href="#">GitHub</a>
    </div>

    <div class="status-display">
        <h4>ğŸ“Š è¯·æ±‚çŠ¶æ€ç›‘æ§</h4>
        <div>
            <strong>æœ€åæ“ä½œ:</strong> <span id="lastAction">ç­‰å¾…æ“ä½œ...</span><br>
            <strong>é“¾æ¥é¢œè‰²:</strong> <span id="linkColor">é»˜è®¤ï¼ˆè“è‰²ï¼‰</span><br>
            <strong>AJAXè¯·æ±‚æ•°:</strong> <span id="requestCount">0</span>
        </div>

        <div class="response-log" id="responseLog">
            <strong>å“åº”æ—¥å¿—:</strong><br>
            <div id="logContent">ç­‰å¾…ç¬¬ä¸€æ¬¡AJAXè¯·æ±‚...</div>
        </div>
    </div>

    <div class="demo-section">
        <h3>ğŸ› ï¸ æŠ€æœ¯å®ç°åŸç†</h3>
        <div style="background: white; padding: 15px; border-radius: 3px;">
            <h4>åç«¯å®ç° (Flask):</h4>
            <ul>
                <li><strong>è·¯ç”±å®šä¹‰</strong>: <code>@app.route('/ajax/say-hello', methods=['POST'])</code></li>
                <li><strong>JSONå“åº”</strong>: ä½¿ç”¨ <code>jsonify()</code> è¿”å›ç»“æ„åŒ–æ•°æ®</li>
                <li><strong>æ•°æ®å¤„ç†</strong>: æ¥æ”¶å‰ç«¯å‘é€çš„JSONæ•°æ®å¹¶å¤„ç†</li>
            </ul>

            <h4>å‰ç«¯å®ç° (JavaScript):</h4>
            <ul>
                <li><strong>fetch API</strong>: ç°ä»£JavaScriptçš„AJAXå®ç°æ–¹å¼</li>
                <li><strong>å¼‚æ­¥å¤„ç†</strong>: ä½¿ç”¨ <code>async/await</code> å¤„ç†å¼‚æ­¥è¯·æ±‚</li>
                <li><strong>DOMæ“ä½œ</strong>: åŠ¨æ€æ›´æ–°é¡µé¢å†…å®¹ï¼Œæ— éœ€åˆ·æ–°</li>
                <li><strong>CSSæ“ä½œ</strong>: åŠ¨æ€æ”¹å˜é¡µé¢å…ƒç´ æ ·å¼</li>
            </ul>
        </div>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <a href="{{ url_for('home') }}" style="color: #6c757d; text-decoration: none;">
            â† è¿”å›ä¸»é¡µ
        </a>
    </div>

    <script>
        // è¯·æ±‚è®¡æ•°å™¨
        let requestCount = 0;

        // æ›´æ–°å“åº”æ—¥å¿—
        function updateLog(message) {
            const logContent = document.getElementById('logContent');
            const timestamp = new Date().toLocaleTimeString();
            logContent.innerHTML = `[${timestamp}] ${message}<br>` + logContent.innerHTML;
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading(show = true) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        function showSuccess(message) {
            const successEl = document.getElementById('successMessage');
            successEl.textContent = message;
            successEl.style.display = 'block';
            setTimeout(() => {
                successEl.style.display = 'none';
            }, 3000);
        }

        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            setTimeout(() => {
                errorEl.style.display = 'none';
            }, 3000);
        }

        // AJAXå‡½æ•° - sayHello
        async function sayHello() {
            showLoading(true);
            requestCount++;

            try {
                const response = await fetch('/ajax/say-hello', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: 'å¼ ä¸‰',
                        lastname: 'æå››'
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // æ˜¾ç¤ºå¼¹çª—
                    alert(data.message);

                    // æ”¹å˜æ‰€æœ‰é“¾æ¥é¢œè‰²ä¸ºç»¿è‰²
                    const links = document.querySelectorAll('.test-links a');
                    links.forEach(link => {
                        link.style.color = '#28a745';
                    });

                    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                    document.getElementById('lastAction').textContent = 'å‘¼å« Hello æˆåŠŸ';
                    document.getElementById('linkColor').textContent = 'ç»¿è‰²';
                    document.getElementById('requestCount').textContent = requestCount;

                    // æ›´æ–°æ—¥å¿—
                    updateLog(`Helloè¯·æ±‚æˆåŠŸ: ${data.message}, æ“ä½œ: ${data.action}`);

                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showSuccess('âœ… Helloæ“ä½œæ‰§è¡ŒæˆåŠŸï¼');
                } else {
                    throw new Error('è¯·æ±‚å¤±è´¥');
                }
            } catch (error) {
                console.error('Error:', error);
                updateLog(`Helloè¯·æ±‚å¤±è´¥: ${error.message}`);
                showError('âŒ Helloè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            } finally {
                showLoading(false);
            }
        }

        // AJAXå‡½æ•° - sayGoodbye
        async function sayGoodbye() {
            showLoading(true);
            requestCount++;

            try {
                const response = await fetch('/ajax/say-goodbye', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({})
                });

                const data = await response.json();

                if (data.success) {
                    // æ˜¾ç¤ºå¼¹çª—
                    alert(data.message);

                    // æ”¹å˜æ‰€æœ‰é“¾æ¥é¢œè‰²ä¸ºçº¢è‰²
                    const links = document.querySelectorAll('.test-links a');
                    links.forEach(link => {
                        link.style.color = '#dc3545';
                    });

                    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                    document.getElementById('lastAction').textContent = 'å‘¼å« Goodbye æˆåŠŸ';
                    document.getElementById('linkColor').textContent = 'çº¢è‰²';
                    document.getElementById('requestCount').textContent = requestCount;

                    // æ›´æ–°æ—¥å¿—
                    updateLog(`Goodbyeè¯·æ±‚æˆåŠŸ: ${data.message}, æ“ä½œ: ${data.action}`);

                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showSuccess('âœ… Goodbyeæ“ä½œæ‰§è¡ŒæˆåŠŸï¼');
                } else {
                    throw new Error('è¯·æ±‚å¤±è´¥');
                }
            } catch (error) {
                console.error('Error:', error);
                updateLog(`Goodbyeè¯·æ±‚å¤±è´¥: ${error.message}`);
                showError('âŒ Goodbyeè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            } finally {
                showLoading(false);
            }
        }

        // é‡ç½®æ ·å¼
        function resetStyles() {
            const links = document.querySelectorAll('.test-links a');
            links.forEach(link => {
                link.style.color = '#007bff';
            });

            document.getElementById('lastAction').textContent = 'æ ·å¼å·²é‡ç½®';
            document.getElementById('linkColor').textContent = 'é»˜è®¤ï¼ˆè“è‰²ï¼‰';

            updateLog('æ ·å¼é‡ç½®ä¸ºé»˜è®¤çŠ¶æ€');
            showSuccess('âœ… æ ·å¼é‡ç½®æˆåŠŸï¼');
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateLog('é¡µé¢åŠ è½½å®Œæˆï¼ŒAJAXåŠŸèƒ½å·²å‡†å¤‡å°±ç»ª');
        });
    </script>
</body>
</html>